<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Mar 16, 2011 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>HTTP Builder - SSL</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20110316" />
    <meta http-equiv="Content-Language" content="en" />
                                                    
<link rel="stylesheet" type="text/css" href="http://alexgorbatchev.com/pub/sh/current/styles/shCore.css" media="all"/>
                                                        
<link rel="stylesheet" type="text/css" href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeFadeToGrey.css" media="all"/>
                                                        
<style>#bodyColumn { max-width: 840px }</style>
                                                        
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js" language="javascript"></script>
                                                        
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushGroovy.js" language="javascript"></script>
                                                        
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushXml.js" language="javascript"></script>
                                                        
<script language="javascript">SyntaxHighlighter.defaults['light'] = true;
			 SyntaxHighlighter.all();</script>
                      
  </head>
  <body class="composite">
    <div id="banner">
                  <a href="index.html" id="bannerLeft">
                                                <img src="../images/logo.png" alt="HTTPBuilder" />
                </a>
                        <a href="../../" id="bannerRight">
                                        <img src="http://media.xircles.codehaus.org/_projects/groovy/_logos/medium.png" alt="Groovy" />
                </a>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                
                <div class="xleft">
        <span id="projectVersion">Version: 0.5.2-SNAPSHOT</span>
              </div>
            <div class="xright">        
                
                 <span id="publishDate">Last Published: 2011-03-16</span>
            </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                
                                <h5>Overview</h5>
                  <ul>
                  <li class="none">
                          <a href="../home.html" title="Home">Home</a>
            </li>
                  <li class="none">
                          <a href="../index.html" title="News">News</a>
            </li>
                  <li class="none">
                          <a href="../download.html" title="Download">Download</a>
            </li>
                                                                                                                                                                                                                                                                                    <li class="expanded">
                          <a href="../doc/index.html" title="Documentation">Documentation</a>
                    <ul>
                      <li class="none">
                          <a href="../doc/get.html" title="GET Examples">GET Examples</a>
            </li>
                      <li class="none">
                          <a href="../doc/post.html" title="POST Examples">POST Examples</a>
            </li>
                      <li class="none">
                          <a href="../doc/json.html" title="Using JSON">Using JSON</a>
            </li>
                      <li class="none">
                          <a href="../doc/xml.html" title="Using XML">Using XML</a>
            </li>
                      <li class="none">
                          <a href="../doc/rest.html" title="RESTClient">RESTClient</a>
            </li>
                      <li class="none">
                          <a href="../doc/async.html" title="AsyncHTTPBuilder">AsyncHTTPBuilder</a>
            </li>
                      <li class="none">
                          <a href="../doc/httpurlclient.html" title="HttpURLClient">HttpURLClient</a>
            </li>
                      <li class="none">
                          <a href="../doc/auth.html" title="Authentication">Authentication</a>
            </li>
                      <li class="none">
                          <a href="../doc/contentTypes.html" title="Content Types">Content Types</a>
            </li>
                      <li class="none">
                          <a href="../doc/handlers.html" title="Response Handlers">Response Handlers</a>
            </li>
                      <li class="none">
                          <a href="../doc/uribuilder.html" title="URIBuilder">URIBuilder</a>
            </li>
                      <li class="none">
            <strong>SSL</strong>
          </li>
              </ul>
        </li>
                  <li class="none">
                          <a href="../apidocs/index.html" title="JavaDoc">JavaDoc</a>
            </li>
                  <li class="none">
                          <a href="../changes.html" title="Changelog">Changelog</a>
            </li>
                  <li class="none">
                          <a href="../contrib.html" title="Contributions">Contributions</a>
            </li>
                  <li class="none">
                          <a href="http://twitter.com/httpbuilder" class="externalLink" title="On Twitter!">On Twitter!</a>
            </li>
                  <li class="none">
                          <a href="https://www.ohloh.net/p/http-builder" class="externalLink" title="On Ohloh">On Ohloh</a>
            </li>
                  <li class="none">
                          <a href="../home.html#Support" title="Support">Support</a>
            </li>
                  <li class="none">
                          <a href="http://blog.thomnichols.org/" class="externalLink" title="Blog">Blog</a>
            </li>
                  <li class="none">
                          <a href="../about.html" title="About">About</a>
            </li>
          </ul>
                       <h5>Additional Reference</h5>
                  <ul>
                  <li class="none">
                          <a href="../../../Documentation" title="Groovy">Groovy</a>
            </li>
                  <li class="none">
                          <a href="http://www.w3.org/Protocols/rfc2616/rfc2616.html" class="externalLink" title="HTTP/1.1 RFC">HTTP/1.1 RFC</a>
            </li>
                  <li class="none">
                          <a href="http://hc.apache.org/httpcomponents-client/" class="externalLink" title="HttpClient">HttpClient</a>
            </li>
                  <li class="none">
                          <a href="http://hc.apache.org/httpcomponents-core/" class="externalLink" title="HttpCore">HttpCore</a>
            </li>
                  <li class="none">
                          <a href="http://json-lib.sourceforge.net/" class="externalLink" title="JSON-Lib">JSON-Lib</a>
            </li>
                  <li class="none">
                          <a href="http://nekohtml.sourceforge.net/" class="externalLink" title="NekoHTML">NekoHTML</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                                        <li class="collapsed">
                          <a href="../project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                                            <li class="collapsed">
                          <a href="../project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                                                                                                                   <a href="http://maven.apache.org/" title="Maven" class="poweredBy">
        <img class="poweredBy"  alt="Maven" src="http://maven.apache.org/images/logos/maven-feather.png"    />
      </a>
                                                                                                    <a href="http://www.ohloh.net/p/http-builder" title="Ohloh" class="poweredBy">
        <img class="poweredBy"  alt="Ohloh" src="http://www.ohloh.net/p/http-builder/widgets/project_thin_badge.gif"    />
      </a>
                       
                
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>SSL Configuration<a name="SSL_Configuration"></a></h2><p>SSL should, for the most part, &quot;just work.&quot; There are a few situations where it is not completely intuitive. You can follow the example below, or see HttpClient's <a class="externalLink" href="http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/conn/ssl/SSLSocketFactory.html">SSLSocketFactory documentation</a> for more information.</p><div class="section"><h3>SSLPeerUnverifiedException<a name="SSLPeerUnverifiedException"></a></h3><p>If you can't connect to an SSL website, it is likely because the certificate chain is not trusted. This is an Apache HttpClient issue, but explained here for convenience. To correct the untrusted certificate, you need to import a certificate into an SSL truststore.</p><p>First, export a certificate from the website using your browser. For example, if you go to <i>https://dev.java.net</i> in Firefox, you will probably get a warning in your browser. Choose &quot;Add Exception,&quot; &quot;Get Certificate,&quot; &quot;View,&quot; &quot;Details tab.&quot; Choose a certificate in the chain and export it as a PEM file. You can view the details of the exported certificate like so:</p><div><pre>$ keytool -printcert -file EquifaxSecureGlobaleBusinessCA-1.crt 
Owner: CN=Equifax Secure Global eBusiness CA-1, O=Equifax Secure Inc., C=US
Issuer: CN=Equifax Secure Global eBusiness CA-1, O=Equifax Secure Inc., C=US
Serial number: 1
Valid from: Mon Jun 21 00:00:00 EDT 1999 until: Sun Jun 21 00:00:00 EDT 2020
Certificate fingerprints:
         MD5:  8F:5D:77:06:27:C4:98:3C:5B:93:78:E7:D7:7D:9B:CC
         SHA1: 7E:78:4A:10:1C:82:65:CC:2D:E1:F1:6D:47:B4:40:CA:D9:0A:19:45
         Signature algorithm name: MD5withRSA
         Version: 3
....</pre></div><p>Now, import that into a Java keystore file:</p><div><pre>$ keytool -importcert -alias &quot;equifax-ca&quot; -file EquifaxSecureGlobaleBusinessCA-1.crt \
&gt; -keystore truststore.jks -storepass test1234
Owner: CN=Equifax Secure Global eBusiness CA-1, O=Equifax Secure Inc., C=US
Issuer: CN=Equifax Secure Global eBusiness CA-1, O=Equifax Secure Inc., C=US
Serial number: 1
Valid from: Mon Jun 21 00:00:00 EDT 1999 until: Sun Jun 21 00:00:00 EDT 2020
Certificate fingerprints:
         MD5:  8F:5D:77:06:27:C4:98:3C:5B:93:78:E7:D7:7D:9B:CC
         SHA1: 7E:78:4A:10:1C:82:65:CC:2D:E1:F1:6D:47:B4:40:CA:D9:0A:19:45
         Signature algorithm name: MD5withRSA
         Version: 3
...
Trust this certificate? [no]:  yes
Certificate was added to keystore</pre></div><p>Now you want to use this truststore in your client:</p><pre class="brush: groovy">import groovyx.net.http.HTTPBuilder
import static groovyx.net.http.Method.HEAD

import java.security.KeyStore
import org.apache.http.conn.scheme.Scheme
import org.apache.http.conn.ssl.SSLSocketFactory

def http = new HTTPBuilder( 'https://www.dev.java.net/' )

def keyStore = KeyStore.getInstance( KeyStore.defaultType )

getClass().getResource( &quot;/truststore.jks&quot; ).withInputStream {
   keyStore.load( it, &quot;test1234&quot;.toCharArray() )
}

http.client.connectionManager.schemeRegistry.register( 
		new Scheme(&quot;https&quot;, new SSLSocketFactory(keyStore), 443) )
		
def status = http.request( HEAD ) {
	response.success = { it.status }
}
</pre></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">Copyright &#169;                   2008-2011.
          All Rights Reserved.      
                
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
